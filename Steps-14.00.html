
Set up ETL  ODS Layer and Populate  Dictionary Tables
14
<p><span style="color: rgb(156, 156, 148); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; font-weight: 700;">Step1: Create an SSIS Package</span><br></p><p><span style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; font-weight: 700;"><font color="#9c9c94">A-Follow the steps on how to create an SSIS&nbsp; package as shown previously.&nbsp; And create package named : </font><font color="#00ff00">3</font></span><font face="Lato, Helvetica, Arial, sans-serif" style="" color="#00ff00"><span style="font-size: 16px;"><b style="">-Load_SeattleCollision_DictionaryTbl</b></span></font></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/1.jpg" style="width: 50%;"><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style=""><br></b></span></font></font></p><p><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style=""><br></b></span></font></font></p><p><span style="color: rgb(156, 156, 148); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; font-weight: 700;">Step2:&nbsp;</span><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Create ETL Sequence Container to Load Seattle Collision Dictionary Tables.</span></p><p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A- Drag and drop a sequence container into the data flow task and name it ODS_Collision</span></p><p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">B- Drag and drop an execute SQL task inside the sequence container as shown</span></p><p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">C-</span><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">&nbsp;</span><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Drag and Drop 4 Data Flow Task into the Sequence Container</span></p><p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><br></span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/2.jpg" style="width: 50%;"><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">.</span></p><p><span style="color: rgb(156, 156, 148); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; font-weight: 700;">Step3: Configure </span><span style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; font-weight: 700;"><font color="#767676">the SQL Task named:&nbsp;</font></span><font face="Lato, Helvetica, Arial, sans-serif" color="#00ff00"><span style="font-size: 16px;"><b style="">SQL-Task_Alter_ODS_Collision_Stg</b></span></font><br></p><p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A-Double click the the SQL task</span></p><p><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">B-Select the&nbsp; appropriate&nbsp;</span></font><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">connection</span><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"> manager :Seattle_Collision_ODS</span></font></p><p><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">C-Copy and paste the SQL code to alter table ODS_Collision_Stg as shown<br></span></font><br><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/3.jpg" style="width: 50%;"><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style=""><br></b></span></font></font></p><p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Step 4: Add a Source, transformations and a destination to the Data Flow Task named:&nbsp;</span><font face="Lato, Helvetica, Arial, sans-serif" color="#00ff00"><span style="font-size: 16px;">DFT-Dictionary_CollisionDetails</span></font></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A. Double Click the Data Flow Task, Then&nbsp; Drag and Drop an OLE DB Source and name it as shown in the image below.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">B. Drag and Drop a Derived Column transformation and name it as shown in the image below.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">C. Drag and Drop a Data conversion conversion transformation</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">D. Drag and Drop a Look Up transformation&nbsp; and name them as shown in the image below.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">E. Drag and Drop an OLE DB Command and name it as shown in the image below.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">F. Drag and Drop an OLE DB Destination and name it as shown in the image below.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">G. Connect them as shown in the image.</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/4.jpg" style="width: 50%;"><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style=""><br></b></span></font></font></p><p><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style=""><br></b></span></font></font></p><p style=""><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><font color="#767676">Step 5: Set Up the OLE DB Source named: </font><font color="#00ff00"><b>Source-Collision_ODS_Stg.</b></font></span></font><br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A. Double Click the OLE DB Source.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">B. Set the OLE DB connection manager to <b>Seattle_Collisions_ODS</b><br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">C. Set the Data access mode to Table and view and select the table&nbsp;<b>Collisions_ODS_Stg</b><br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">D. Select the column needed and do the mapping as shown on the image below.<br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">E. Click OK.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/5.jpg" style="width: 50%;"><br></p><p><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style=""><br></b></span></font></font></p><p style=""><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">Step 6: Set up the Derived Column transformation named</span></font><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; background-color: transparent;"><font color="#0000FF">&nbsp;</font></span><font color="#00ff00"><b><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">DC-Add_Active_CreateBy</span></font><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">.</span></font></b></font></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A. Double Click the Derived Column transformation.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">B. Set the Derived Column Name section as shown in the image below.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">C. Set the Derived Column section as shown in the image below.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">D. Type the code in the Expression Tab as shown in image below.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/6.jpg" style="width: 50%;"><br></p><p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Step 7: Set up the Data conversion&nbsp; transformation</span></p><p><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">A. Double Click the Data&nbsp;conversion</span></font></p><p><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">B. Set up the&nbsp; output Alias column the column column&nbsp; length&nbsp;as shown on the image below</span></font></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/11.jpg" style="width: 50%;"><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><br></span><br></font></p><p style=""><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">Step 8: Set up the Look Up transformation named</span></font><font color="#00ff00"><b><span style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><font style="">&nbsp;</font></span><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">Lookup_CollisionDetailsID</span></font></b></font><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">.</span></font></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A. Double Click the Look Up transformation and set up the first three Tab of the transformation editor as shown.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">B. Configure the General Tab as Shown.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">C. Configure the Connection Tab as Shown.</span></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">C. Configure the Column Tab as Shown.<br></span></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/8.jpg" style="width: 50%;"><br></p><p><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style=""><br></b></span></font></font></p><p style=""><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">Step 9: Configure the OLE DB Command&nbsp;&nbsp;</span></font><font face="Lato, Helvetica, Arial, sans-serif" style="" color="#00ff00"><span style="font-size: 16px;">ODC-UpdateDicCollisionDetails</span></font><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">.</span></font><br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A. Double Click the OLE DB Command.<br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">B. Configure the Connection Manager Tab as shown. Select the connection manager <b>Seattle_Collision_ODS</b>.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">C. Configure the component property&nbsp; Tab as shown. Double on the three dots on the SQL command option.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Then copy an paste the code&nbsp; from the file <b>OLE DB Command UPDATE Dictionary_CollisionDetails</b></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/9.jpg" style="width: 50%;"><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style=""><br></b></span></font></font></p><p><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style="">D. Configure the column mapping as shown below and click ok</b></span></font></font></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/10.jpg" style="width: 50%;"><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style=""><br></b></span></font></font></p><p><font color="#9c9c94"><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><b style=""><br></b></span></font></font></p><p style=""><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">Step 10: Configure the OLE DB Destination named </span></font><font color="#00ff00"><b><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">Destination-Dictionary_ColisionDetails</span></font><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">.</span></font></b></font><br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A. Double Click the OLE DB Destination.<br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">B. Configure the Connection Manager Tab as shown.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">C. Configure the Mappings Tab as shown.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/15.jpg" style="width: 50%;"></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Step 11: Configure 3 other dictionary Data Flow Tasks</p><p style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><span style="color: rgb(118, 118, 118);">A. Repeat Steps 4 - 10 to configure&nbsp;</span><font color="#00ff00"><b>DFT-Dictionary_EnvironmentalFactor</b></font><font color="#767676">, </font><b style=""><font color="#00ff00">DFT-Dictionary_HumanFactor </font><font color="#9c9c94">and</font></b><br></p><div><font color="#00ff00">DFT-Dictionary_Severity</font><br></div><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/12.jpg" style="width: 50%;"></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Check the diagrams below for the out look of the data flow tasks<br></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/8/13.jpg" style="width: 50%;"><br></p>

<a href="https://youtu.be/qOXnU_03j9s" target="_blank" style="background-color: rgb(255, 255, 255); color: rgb(35, 82, 124); text-decoration: underline; outline: 0px; font-family: sans-serif; font-weight: 400;"><span style="font-family: Verdana;">The OLE DB Command in SSIS</span></a>

