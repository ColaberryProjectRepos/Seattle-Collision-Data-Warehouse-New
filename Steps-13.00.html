
Set up ETL  ODS Layer Populate ODS  Staging Table
13
<p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Step 1: Create ODS Tables</span><br></p><p style=""><font color="#767676" style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A. Open&nbsp;&nbsp;</font><span style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; background-color: transparent;"><font color="#00ff00"><b>Collisions_ODS</b></font></span><font color="#767676" style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">&nbsp;file, located in the </font><font color="#00ff00" style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><b>Seattle_Collisions_ODS</b></font><font color="#767676" style=""><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">&nbsp;Folder from the project&nbsp;folder.</span></font></font></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">B. Executing the code will create all the ODS tables for the ODS layer.</p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/7/1.jpg" style="width: 50%;"></p><p style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><span style="color: rgb(118, 118, 118);">Step 2: Create a package&nbsp; to Load Staging Tables</span><font color="#00ff00"><b> ODS_Collision_Stg.</b></font></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A. Right click on SSIS Packages on the solution explorer.</p><p style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><span style="color: rgb(118, 118, 118);">B-Name your new Package following the naming convention</span><font color="#00ff00"> <b>2-Load_ODS_Collision_Stg</b></font></p><p style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/7/2.jpg" style="width: 50%;"><font color="#00ff00"><b><br></b></font></p><p style=""><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">Step 3: On the control&nbsp;flow panel&nbsp;</span></font></p><p style=""><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">Follow the steps as previously done when creating&nbsp;the first package (1-Load_Collision_Stg)</span></font></p><p style=""><font color="#767676" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">A- drag and drop a sequence container</span></font></p><p style=""><font face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><font color="#767676">B- inside the sequence&nbsp;container&nbsp; bring in a Data flow task (</font><font color="#00ff00">DFT-Load_ODS_Collision_Stg</font><font color="#767676">) and an Execute SQL task </font><font color="#00ff00">Update _ODS_Collision_Stg </font><font color="#9c9c94">as</font><font color="#00ff00">&nbsp;</font></span></font><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">&nbsp;shown below</span></p><p style=""><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">C- Outside on the sequence container drag and drop an execute SQL Task Truncate_ODS_Collision_Stg</span></p><p style=""><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/7/4.jpg" style="width: 50%;"><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><br></span></p><p style=""><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">D- Double click on&nbsp;</span><font color="#767676" style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Execute SQL task&nbsp;</font><font color="#00ff00" style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Update _ODS_Collision_Stg to configure </font><font style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;" color="#9c9c94">it</font></p><p style=""><font color="#9c9c94" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">E-&nbsp; Open the file SQL task&nbsp;</span></font><span style="color: rgb(156, 156, 148); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">update ODS_Collision_Stg,</span><span style="font-size: 16px; color: rgb(156, 156, 148); font-family: Lato, Helvetica, Arial, sans-serif;">&nbsp;located in the folder Seattle_Collision_ODS of the project file. Then&nbsp; Copy an paste the query to update ODS_Collision_Stg as shown below.</span></p><p style=""><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/7/5.jpg" style="width: 50%;"></p><p style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><font color="#9c9c94">Step 4: Configure the data flow task</font><span style="color: rgb(118, 118, 118);">&nbsp;<span style="color: rgb(0, 255, 0);">DFT-Load_ODS_Collision_Stg</span></span></p><p style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><font color="#9c9c94">A- Drag and drop an OLE DB source , name it and double click to configure it</font></p><p style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><font color="#9c9c94">B-Select the connection manger Seattle_Collision_Staging&nbsp; for the connection and Collision_Stg as source table</font></p><p style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><font color="#9c9c94">C-Select all the column from the source table</font></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><span style="color: rgb(0, 255, 0);"><br></span></p><p style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/7/6.jpg" style="width: 50%;"><span style="color: rgb(0, 255, 0);"><br></span></p><p style=""><font face="Lato, Helvetica, Arial, sans-serif" color="#9c9c94"><span style="font-size: 16px;">D-Drag and drop a derived column&nbsp;transformation , name it as shown. Connect&nbsp; OLE DB source to it .Then double click it to configure.</span></font></p><p><span style="font-family: Tahoma;"><font color="#9c9c94">E. Set the Derived Column Name section as shown in the image below.</font></span></p><p><span style="font-family: Tahoma;"><font color="#9c9c94">F. Set the Derived Column section (add new column)as shown in the image below.</font></span></p><p><span style="font-family: Tahoma;"><font color="#9c9c94">G. Type the code in the Expression Tab as shown in image below( Code available in file&nbsp;</font></span><font color="#9c9c94" face="Tahoma">Collison_ODS_Derived Column on the Seattle_Collision _ODS folder)</font></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/7/7.jpg" style="width: 50%;"><font color="#9c9c94" face="Tahoma"><br></font></p><p><font color="#9c9c94">H- Drag and drop a data conversion transformation, and double click to configure</font>&nbsp;</p><p><span style="font-family: Tahoma;"><font color="#9c9c94">I. Select the two new column added.</font></span></p><p><span style="font-family: Tahoma;"><font color="#9c9c94">J. Set the output alias as shown in the image below.</font></span></p><p><font color="#9c9c94" style=""><font face="Tahoma">K. Select te right data&nbsp;type that matches the destination column data type as shown in image below</font></font></p><p><font color="#9c9c94" style=""><font face="Tahoma">L- Select the right matching&nbsp;</font></font><font color="#9c9c94" face="Tahoma">length as shown</font></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/7/8.jpg" style="width: 50%;"><font color="#9c9c94" face="Tahoma"><br></font></p><p><font color="#9c9c94" style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">Step 5: Configure t</font><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">he OLE DB Destination named&nbsp;</span><span style="font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px; color: rgb(118, 118, 118);">&nbsp;</span><font color="#00ff00" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;">Destination-ODS_Collision_Stg</span></font></p><p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">A. Double Click the OLE DB Destination.</span></p><p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">B. Configure the Connection Manager Tab as shown.</span></p><p><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">C. Select ODS_Collision_Stg as the destination table as shown on the image below</span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/7/9.jpg" style="width: 50%;"><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><br></span><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><br></span><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;">D. Configure the Mappings Tab as shown and click OK</span></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1293/7/10.jpg" style="width: 50%;"><span style="color: rgb(118, 118, 118); font-family: Lato, Helvetica, Arial, sans-serif; font-size: 16px;"><br></span><font color="#00ff00" face="Lato, Helvetica, Arial, sans-serif"><span style="font-size: 16px;"><br></span></font><font color="#9c9c94" face="Tahoma"><br></font></p><p><font color="#9c9c94" style=""><font face="Tahoma"><br></font></font></p>

<a href="https://youtu.be/E387jsEnImE?list=TLPQMDYwNzIwMjNEn4_NIK52jw" target="_blank" style="background-color: rgb(255, 255, 255); color: rgb(35, 82, 124); text-decoration: underline; outline: 0px; font-family: sans-serif; font-weight: 400;">Basic derived column transformation</a>

